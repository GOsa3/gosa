<?xml version="1.0" encoding="UTF-8"?>
<Objects xmlns="http://www.gonicus.de/Objects">
  <Object>
    <Name>ForemanHost</Name>
    <DisplayName>Deployment</DisplayName>
    <Description>The foreman - this device is managed by foreman</Description>
    <Templates>
      <Template>foreman-host.json</Template>
    </Templates>
    <BackendParameters>
      <Backend objectClasses="foremanHost">LDAP</Backend>
      <Backend type="hosts" _uuidAttribute="cn">Foreman</Backend>
      <Backend groupMembership="ForemanHostGroup:foremanGroupId,member=dn">ObjectHandler</Backend>
    </BackendParameters>
    <Backend>LDAP</Backend>
    <BaseObject>false</BaseObject>
    <Attributes>
      <ForeignAttribute>
        <Name>cn</Name>
      </ForeignAttribute>
      <ForeignAttribute>
        <Name>ipHostNumber</Name>
      </ForeignAttribute>
      <ForeignAttribute>
          <Name>macAddress</Name>
      </ForeignAttribute>
      <Attribute>
        <Name>status</Name>
        <Description>The foreman - current device status</Description>
        <Type>String</Type>
        <Default>unknown</Default>
        <ReadOnly>true</ReadOnly>
        <InFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>ForemanStatusIn</Name>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </InFilter>
        <Values>
          <Value key="unknown">Unknown</Value>
          <Value key="pending">Pending</Value>
          <Value key="install">Installing</Value>
          <Value key="deploy">Deploying</Value>
          <Value key="ready">Ready</Value>
          <Value key="warning">Warning</Value>
          <Value key="error">Error</Value>
        </Values>
        <DependsOn>
          <Attribute>build_status</Attribute>
          <Attribute>global_status</Attribute>
        </DependsOn>
      </Attribute>
      <Attribute>
        <Name>groupMembership</Name>
        <Description>Assigned host group</Description>
        <Type>String</Type>
        <Backend>ObjectHandler</Backend>
        <Validators>
          <Condition>
            <Name>ObjectWithPropertyExists</Name>
            <Param>ForemanHostGroup</Param>
            <Param>foremanGroupId</Param>
          </Condition>
        </Validators>
      </Attribute>
      <Attribute>
        <Name>build_status</Name>
        <Description>Foreman build status ID</Description>
        <Type>Integer</Type>
        <Backend>Foreman</Backend>
        <ReadOnly>true</ReadOnly>
      </Attribute>
      <Attribute>
        <Name>global_status</Name>
        <Description>Foreman global status ID</Description>
        <Type>Integer</Type>
        <Backend>Foreman</Backend>
        <ReadOnly>true</ReadOnly>
      </Attribute>
      <Attribute>
        <Name>hostgroup_id</Name>
        <Description>ID of the hostgroup this host is part of</Description>
        <Type>String</Type>
        <BackendType>Integer</BackendType>
        <Backend>Foreman</Backend>
        <DependsOn>
          <Attribute>groupMembership</Attribute>
        </DependsOn>
        <InFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>IntegerToString</Name>
              </Filter>
            </FilterEntry>
            <FilterEntry>
              <Filter>
                <Name>CopyValueTo</Name>
                <Param>groupMembership</Param>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </InFilter>
        <OutFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>CopyValueFrom</Name>
                <Param>groupMembership</Param>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </OutFilter>
      </Attribute>
      <Attribute>
        <Name>name</Name>
        <Type>UnicodeString</Type>
        <Backend>Foreman</Backend>
        <DependsOn>
          <Attribute>cn</Attribute>
        </DependsOn>
        <InFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>CopyValueTo</Name>
                <Param>cn</Param>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </InFilter>
        <OutFilter>
          <FilterChain>
            <FilterEntry>
              <Filter>
                <Name>CopyValueFrom</Name>
                <Param>cn</Param>
              </Filter>
            </FilterEntry>
          </FilterChain>
        </OutFilter>
      </Attribute>
    </Attributes>
    <Extends>
      <Value>Device</Value>
    </Extends>
  </Object>
</Objects>
